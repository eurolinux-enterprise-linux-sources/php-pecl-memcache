
http://pecl.php.net/bugs/bug.php?id=13623

http://svn.php.net/viewvc?view=revision&revision=305234

https://bugzilla.redhat.com/show_bug.cgi?id=696649

--- memcache-3.0.5/memcache_queue.c
+++ memcache-3.5.0/memcache_queue.c
@@ -27,6 +27,8 @@
 #include "memcache_queue.h"
 
 inline void mmc_queue_push(mmc_queue_t *queue, void *ptr) {
+	if (mmc_queue_contains(queue, ptr)) return;
+
 	if (queue->len >= queue->alloc) {
 		int increase = 1 + MMC_QUEUE_PREALLOC;
 		queue->alloc += increase;
